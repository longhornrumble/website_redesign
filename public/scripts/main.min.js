const SCROLL_THRESHOLD=50,SWIPE_THRESHOLD=50,ANIMATION_DURATION=1500,FADE_IN_THRESHOLD=.1,SETUP_ANIMATION_THRESHOLD=.2;document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("header"),t=document.getElementById("logo-default"),n=document.getElementById("logo-scrolled"),a="true"===e?.dataset.forceScrolled;function s(){if(a)return;window.scrollY>50?(e?.classList.add("scrolled"),t?.classList.add("hidden"),n?.classList.remove("hidden")):(e?.classList.remove("scrolled"),t?.classList.remove("hidden"),n?.classList.add("hidden"))}window.addEventListener("scroll",s),a||s();const o=document.getElementById("mobile-menu-btn"),d=document.getElementById("mobile-menu"),l=document.querySelectorAll(".mobile-nav-link");function i(){o?.classList.remove("open"),d?.classList.remove("open"),o?.setAttribute("aria-expanded","false"),o?.focus()}o&&d&&(o.setAttribute("aria-expanded","false"),o.setAttribute("aria-controls","mobile-menu"),o.addEventListener("click",()=>{o.classList.contains("open")?i():function(){o?.classList.add("open"),d?.classList.add("open"),o?.setAttribute("aria-expanded","true");const e=d?.querySelector("a");e?.focus()}()}),l.forEach(e=>{e.addEventListener("click",i)}),document.addEventListener("keydown",e=>{"Escape"===e.key&&o.classList.contains("open")&&i()}),d.addEventListener("keydown",e=>{if("Tab"!==e.key)return;const t=d.querySelectorAll("a[href], button:not([disabled])"),n=t[0],a=t[t.length-1];e.shiftKey&&document.activeElement===n?(e.preventDefault(),a?.focus()):e.shiftKey||document.activeElement!==a||(e.preventDefault(),n?.focus())}));document.querySelectorAll(".faq-btn").forEach(e=>{e.addEventListener("click",()=>{if(window.innerWidth<768){const t=e.closest(".faq-item");t?.classList.toggle("open")}})});const c=document.getElementById("billing-monthly"),r=document.getElementById("billing-annual"),u=document.getElementById("standard-price"),m=document.getElementById("premium-price"),h=document.getElementById("standard-billing-note"),g=document.getElementById("premium-billing-note"),y=document.getElementById("standard-cta"),E=document.getElementById("premium-cta-save"),v=document.getElementById("billing-message");function L(e){c?.setAttribute("aria-checked",(!e).toString()),r?.setAttribute("aria-checked",e.toString()),e?(u&&(u.textContent="120"),m&&(m.textContent="240"),h?.classList.remove("hidden"),g?.classList.remove("hidden"),y&&(y.textContent="Get Started â€” Save 20%"),E?.classList.remove("hidden"),v&&(v.textContent="Billed annually. Switch to monthly anytime."),r?.classList.add("bg-emerald-500","text-white"),r?.classList.remove("text-slate-600","hover:text-slate-900"),c?.classList.remove("bg-emerald-500","text-white"),c?.classList.add("text-slate-600","hover:text-slate-900")):(u&&(u.textContent="150"),m&&(m.textContent="300"),h?.classList.add("hidden"),g?.classList.add("hidden"),y&&(y.textContent="Get Started"),E?.classList.add("hidden"),v&&(v.textContent="Billed monthly. Switch to annual anytime."),c?.classList.add("bg-emerald-500","text-white"),c?.classList.remove("text-slate-600","hover:text-slate-900"),r?.classList.remove("bg-emerald-500","text-white"),r?.classList.add("text-slate-600","hover:text-slate-900"))}c&&r&&(c.setAttribute("role","radio"),c.setAttribute("aria-checked","true"),r.setAttribute("role","radio"),r.setAttribute("aria-checked","false"),c.addEventListener("click",()=>L(!1)),r.addEventListener("click",()=>L(!0)),[c,r].forEach(e=>{e.addEventListener("keydown",e=>{if("ArrowLeft"===e.key||"ArrowRight"===e.key){e.preventDefault();document.activeElement===c?(r.focus(),L(!0)):(c.focus(),L(!1))}})}));const f=document.querySelectorAll(".checkout-btn"),b=document.getElementById("checkout-modal"),w=document.getElementById("checkout-modal-backdrop"),p=document.getElementById("checkout-modal-close"),k=document.getElementById("checkout-form"),x=document.getElementById("checkout-plan"),I=document.querySelectorAll('input[name="taxExempt"]'),A=document.getElementById("ein-field"),S=document.getElementById("checkout-submit");let B=!1;function C(){b&&b.classList.add("hidden"),document.body.style.overflow=""}c&&r&&(c.addEventListener("click",()=>{B=!1}),r.addEventListener("click",()=>{B=!0})),f.forEach(e=>{e.addEventListener("click",()=>{const t=B?e.dataset.planAnnual:e.dataset.planMonthly;x&&(x.value=t),b&&b.classList.remove("hidden"),document.body.style.overflow="hidden",document.getElementById("checkout-name")?.focus()})}),p?.addEventListener("click",C),w?.addEventListener("click",C),document.addEventListener("keydown",e=>{"Escape"===e.key&&b&&!b.classList.contains("hidden")&&C()}),I.forEach(e=>{e.addEventListener("change",e=>{A&&("yes"===e.target.value?A.classList.remove("hidden"):A.classList.add("hidden"))})}),k?.addEventListener("submit",async e=>{e.preventDefault();const t=new FormData(k),n=t.get("plan"),a=t.get("contactName"),s=t.get("email"),o=t.get("organizationName"),d="yes"===t.get("taxExempt"),l=t.get("ein");S&&(S.disabled=!0,S.textContent="Redirecting...");try{const e=await fetch("/api/checkout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({plan:n,contactName:a,email:s,organizationName:o,taxExempt:d,ein:l})}),t=await e.json();if(!t.url)throw new Error(t.error||"Failed to create checkout");window.location.href=t.url}catch(e){console.error("Checkout error:",e),S&&(S.disabled=!1,S.textContent="Continue to Checkout"),alert("Something went wrong. Please try again.")}});const D=document.querySelectorAll(".carousel-tab"),q=document.querySelectorAll(".carousel-slide"),T=document.querySelectorAll("[data-indicator]"),N=document.getElementById("carousel-slides"),O=q.length||3;let H=0,R=null;function M(e){H=e,D.forEach((t,n)=>{const a=n===e;t.setAttribute("aria-selected",a.toString()),t.setAttribute("tabindex",a?"0":"-1"),a?(t.classList.add("bg-emerald-500","text-white","shadow-lg","shadow-emerald-500/25"),t.classList.remove("bg-slate-800","text-slate-400","hover:bg-slate-700","hover:text-white")):(t.classList.remove("bg-emerald-500","text-white","shadow-lg","shadow-emerald-500/25"),t.classList.add("bg-slate-800","text-slate-400","hover:bg-slate-700","hover:text-white"))}),T.forEach((t,n)=>{n===e?(t.classList.add("w-8","bg-emerald-500"),t.classList.remove("w-2","bg-slate-700")):(t.classList.remove("w-8","bg-emerald-500"),t.classList.add("w-2","bg-slate-700"))}),q.forEach((t,n)=>{n===e?(t.classList.remove("hidden"),t.setAttribute("aria-hidden","false"),_(t)):(t.classList.add("hidden"),t.setAttribute("aria-hidden","true"))})}function _(e){e.querySelectorAll(".counter").forEach(e=>{const t=parseFloat(e.dataset.target),n=parseInt(e.dataset.decimals)||0;isNaN(t)||t<0?console.warn("Invalid counter target:",e.dataset.target):(e.textContent="0",function(e,t,n=1500,a=0){let s=0;const o=t/(n/16),d=setInterval(()=>{s+=o,s>=t?(e.textContent=a>0?t.toFixed(a):Math.floor(t).toLocaleString(),clearInterval(d)):e.textContent=a>0?s.toFixed(a):Math.floor(s).toLocaleString()},16)}(e,t,1500,n))})}D.forEach((e,t)=>{e.setAttribute("role","tab"),e.setAttribute("aria-selected",0===t?"true":"false"),e.setAttribute("tabindex",0===t?"0":"-1"),e.addEventListener("click",()=>M(t)),e.addEventListener("keydown",e=>{let t=H;"ArrowLeft"===e.key?(e.preventDefault(),t=(H-1+O)%O):"ArrowRight"===e.key?(e.preventDefault(),t=(H+1)%O):"Home"===e.key?(e.preventDefault(),t=0):"End"===e.key&&(e.preventDefault(),t=O-1),t!==H&&(M(t),D[t]?.focus())})}),q.forEach((e,t)=>{e.setAttribute("role","tabpanel"),e.setAttribute("aria-hidden",0===t?"false":"true")}),N&&(N.addEventListener("touchstart",e=>{R=e.touches[0].clientX}),N.addEventListener("touchend",e=>{if(!R)return;const t=e.changedTouches[0].clientX,n=R-t;Math.abs(n)>50&&(M(n>0?(H+1)%O:(H-1+O)%O),setTimeout(()=>{document.getElementById("slide-eyebrow")?.scrollIntoView({behavior:"smooth",block:"start"})},50)),R=null})),q.length>0&&_(q[0]);const F=document.querySelectorAll(".fade-in"),P=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){const t=e.target.style.transitionDelay||"0ms",n=parseInt(t);setTimeout(()=>{e.target.classList.add("visible")},n)}})},{threshold:.1});F.forEach(e=>P.observe(e));const j=document.getElementById("setup"),z=document.querySelectorAll(".setup-dot");if(j&&z.length>0){const e=new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting&&(z.forEach(e=>{const t=e.dataset.delay||"0s";e.style.animation="sequentialPulse 11s infinite",e.style.animationDelay=t}),e.unobserve(t.target))})},{threshold:.2});e.observe(j)}});